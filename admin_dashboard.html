<script>
  const API_BASE = "https://cognitive-disorder-backend-7.onrender.com";

  // ðŸ” Protect page
  if (!localStorage.getItem("adminLoggedIn")) {
    window.location.href = "admin-login.html";
  }

  // ðŸ“Š Load dashboard stats
  fetch(`${API_BASE}/admin-dashboard-stats`, {
    credentials: "include"   // ðŸ”¥ REQUIRED
  })
    .then(res => {
      if (!res.ok) throw new Error("Unauthorized");
      return res.json();
    })
    .then(data => {
      document.getElementById("users").innerText = data.users;
      document.getElementById("reports").innerText = data.reports;
      document.getElementById("accuracy").innerText = data.best_accuracy + "%";
    })
    .catch(err => {
      console.error("Stats load failed", err);
      alert("Session expired. Please login again.");
      window.location.href = "admin-login.html";
    });

  // ðŸšª Logout
  function logout() {
    fetch(`${API_BASE}/admin-logout`, {
      credentials: "include"
    }).finally(() => {
      localStorage.removeItem("adminLoggedIn");
      window.location.href = "admin-login.html";
    });
  }
</script>
